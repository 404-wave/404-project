<!-- Reason for having the templates folder at the root.-->
<!-- https://stackoverflow.com/questions/54730747/how-do-i-use-a-template-from-one-app-in-another-app/54731001#54731001 -->
<!-- templates/home.html -->

<!-- Note: we can change this to be more robust by redirecting to a different homepage if the user is not authenticated -->

<!DOCTYPE html>

<head>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  <link
    rel="stylesheet"
    type="text/css"
    href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css"
  />
</head>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- popper -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>

    <title>Hello, world!</title>
  </head>
  <body>
    <h1>Homepage</h1>
    {% if user.is_authenticated %}

    <a href="{% url 'logout' %}">Logout</a>
    {% if user.is_admin %}
    <p><a href="{% url 'administration' %}">Admin</a></p>
    {% endif %} {% else %}
    <p>Please <a href="{% url 'login' %}">login</a>.</p>
    {% endif %}

    <form method="GET" action="">
      <input
        type="text"
        name="query"
        placeholder="Search posts"
        value="{{ request.GET.query }}"
      />
      <input type="Submit" value="Search" />
      <a href="/home">Clear search</a>
    </form>

    <h1>What's on your mind, {{ user }}</h1>



    {% if unlisted_instance %}
      <p> Your posts was created. Access it <a href="{{ unlisted_instance.get_detail_absolute_url }}"> Here</a></p>
    {% endif %}

    <h3>Create Post</h3>

    <form method="POST" action="" , enctype="multipart/form-data" novalidate>
      {% csrf_token %}
      {{ form.as_p }}
      <input type="submit" class="btn btn-primary" value="Share" />
      </div>
    </form>

    <div class="row">
      {% for obj in object_list %}
      <!-- check if is Post object -->
      {% if obj.user %}
      <div class="col-sm-6 col-md-4">
        <!-- column 1 -->
        <div class="thumbnail">
          <!--  thumbnail 1  -->
          <br />
          {% if obj.image %}
          <img src="{{ obj.image.url }}" alt="" /> <br />
          {% endif %}
          <div class="caption">
            <!-- caption -->
            <h4>
              {{ obj.user }}
              <a href="{{ obj.get_detail_absolute_url }}">{{ obj.status }}</a>
              {{ obj.timestamp }}
              <!-- | timesince | ago -->
            </h4>
            <p>
              {{ obj.content | linebreaks }}
            </p>
            <p>
              <a
                href="{{ obj.get_detail_absolute_url }}"
                class="btn btn-primary"
                role="button"
                >View</a
              >
            </p>
            {% if obj.user == request.user %}
              <p>
                <a
                  href="{{ obj.get_edit_absolute_url }}"
                  class="btn btn-primary"
                  role="button"
                  >Edit</a
                >
              </p>
              <!-- btn 2 -->
              <p>
                <a
                  href="{{ obj.get_delete_absolute_url }}"
                  class="btn btn-primary"
                  role="button"
                  >Delete</a
                >
              </p>
            {% endif %}

  
            
            <div class="dropdown">
              <button
                class="btn btn-secondary dropdown-toggle"
                type="button"
                id="dropdownMenuButton"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                Privacy setting
              </button>
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" href=""
                  >{{ obj.get_privacy_display }} </a
                >
              </div>
            </div>
            <!-- PUT COMMENT SECTION HERE. -->
          </div>
        </div>
      </div>
      {% else %}
      <div class="col-sm-6 col-md-4">
        <p>{{ obj }}</p>
      </div>

      {% endif %} {% endfor %}
    </div>

    <!-- Local js -->
    {% load static %}
    <script>

        function private(){
          var values = $("#id_privacy").val();
        if(values == 1){
          $("#id_accessible_users").parent().show();
        }
        else
          $("#id_accessible_users").parent().hide();
        }

      $("#id_privacy").change(function(){
        private();
      })
      private();
    
    
    </script>
  </body>
</html>
